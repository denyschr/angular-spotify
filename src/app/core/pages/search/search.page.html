<ng-container *ngIf="(vm$ | async) as vm; else loader">
	<ng-container [ngSwitch]="vm.search ? 'search' : 'categories'">
		<ng-container *ngSwitchCase="'categories'" [ngTemplateOutlet]="categorySection"
			[ngTemplateOutletContext]="{$implicit: vm.categories}"></ng-container>
		<ng-container *ngSwitchCase="'search'" [ngTemplateOutlet]="searchSection"
			[ngTemplateOutletContext]="{$implicit: vm.search}"></ng-container>
	</ng-container>
</ng-container>

<ng-template #categorySection let-categories>
	<app-category-section *ngIf="categories.length" [sectionTitle]="'Browse All'" [categories]="categories"
		[mediaContent]="categories"></app-category-section>
</ng-template>

<ng-template #searchSection let-search>
	<ng-container *ngIf="search.searchResults; else noResults">
		<app-search-nav [mediaTypes]="search.mediaTypes" (selectedMediaType)="updateMediaType($event)">
		</app-search-nav>
		<app-top-result-section *ngIf="search.tracks?.items.length" [sectionTitle]="'Top result'"
			[mediaContent]="search.tracks?.items">
		</app-top-result-section>
		<app-song-section *ngIf="search.tracks?.items.length" [sectionTitle]="'Songs'"
			[mediaContent]="search.tracks?.items">
		</app-song-section>
		<app-base-section *ngIf="search.artists?.items.length" [sectionTitle]="'Artists'"
			[mediaContent]="search.artists?.items">
		</app-base-section>
		<app-base-section *ngIf="search.albums?.items.length" [sectionTitle]="'Albums'"
			[mediaContent]="search.albums?.items" [isAlbumDate]="true">
		</app-base-section>
		<app-base-section *ngIf="search.playlists?.items.length" [sectionTitle]="'Playlists'"
			[mediaContent]="search.playlists?.items">
		</app-base-section>
	</ng-container>
</ng-template>

<ng-template #noResults>
	<div class="no-results">
		<div class="no-results__container">
			<h1 class="no-results__title text-size-larger">No results found for "{{currentSearchTerm}}"</h1>
			<p class="no-results__text">
				Please make sure your words are spelled correctly, or use fewer or different keywords.
			</p>
		</div>
	</div>
</ng-template>

<ng-template #loader>
	<span class="loader"></span>
</ng-template>